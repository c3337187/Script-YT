# Script-YT

Script-YT — минималистичный загрузчик контента на базе `yt_dlp`.
Программа поддерживает два режима работы: графический интерфейс на
Tkinter и консольный без окна (`--headless`).  Настройки хранятся в
`config.json`, а все события и ошибки пишутся в `script.log`.  В
графическом режиме приложение сворачивается в системный трей и может
управляться через значок с меню на русском языке.
Интерфейс оформлен в тёмно‑серых тонах с закруглёнными кнопками и
четырёхточечным индикатором прогресса.

## Проверка зависимостей

Перед запуском убедитесь, что все необходимые пакеты установлены.
Проще всего выполнить:

```bash
python check_packages.py
```

Скрипт попытается установить отсутствующие библиотеки через `pip`.

Необходимые пакеты вручную:

```bash
pip install yt_dlp pyperclip keyboard pillow pystray requests beautifulsoup4
```

На Windows дополнительно требуется `pywin32`.

## Запуск

Графический режим:

```bash
python gui_downloader.py
```

Без графики (вывод статуса в консоль):

```bash
python gui_downloader.py --headless
```

Используйте горячие клавиши, указанные в `config.json`:
`add_hotkey` добавляет ссылку из буфера обмена,
`download_hotkey` запускает скачивание очереди.
При работе в графическом режиме окно можно скрыть в трей. Меню значка
позволяет запустить загрузку, открыть папку назначения или выйти из
приложения.

На Windows горячие клавиши регистрируются через `pywin32`, что
минимизирует конфликты с системными комбинациями.

> **Note**
> В окружениях без `dumpkeys` или устройства `uinput`
> библиотека `keyboard` может не регистрировать горячие клавиши.
> В этом случае запускайте функции вручную через GUI или консольные
> команды.

## Сборка exe

Чтобы создать исполняемый файл понадобиться `PyInstaller`. Установите
его при необходимости:

```bash
pip install pyinstaller
```

Затем запустите helper‑скрипт:

```bash
python build_exe.py
```

Он сначала проверит зависимости, скомпилирует исходники и только
затем вызовет PyInstaller. При
желании можно выполнить команду напрямую:

```bash
pyinstaller --onefile --windowed --icon=ico.ico \
  --add-data="ico.ico;." --add-data="act.ico;." \
  --add-data="dw.ico;." --add-data="config.json;." \
  gui_downloader.py
```

## Структура кода

- **`load_config()`** — считывает настройки из `config.json`,
  объединяя их с значениями по умолчанию.
- **`save_config(cfg)`** — сохраняет переданный словарь настроек в файл.
- **`ensure_download_dir(path)`** — гарантирует наличие каталога загрузок.
- **`download_url(url, folder, progress_callback)`** — скачивает указанную
  ссылку через `yt_dlp`.
- **`run_headless()`** — запускает консольный режим без графического окна.
- **`App`** — класс Tkinter, реализующий интерфейс выбора пути, настройку
  горячих клавиш и отображение прогресса.
- **`TrayController`** — управляет значком в системном трее и меню.

В окне присутствует поле для ввода ссылки вручную и кнопка «Добавить»,
позволяющая пополнить очередь без использования буфера обмена.

Прогресс скачивания отображается в виде четырёх кругов, каждый из
которых заполняется по мере достижения 25 % общего прогресса.

Логика работы проста: пользователь добавляет ссылки в очередь, после чего
нажимает горячую клавишу запуска или кнопку в интерфейсе. Каждая ссылка
скачивается в выбранную папку, а ход процесса отображается либо в окне,
либо в терминале при работе без GUI.

