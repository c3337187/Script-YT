# Описание функций main_windows_strict.py

Документ кратко объясняет назначение каждой функции в файле `main_windows_strict.py`. Такой справочник позволяет быстрее разобраться в коде и вносить изменения.

- **get_base_folder()** — возвращает путь к каталогу, где хранятся все вспомогательные файлы приложения. Если программа упакована в exe, используется расположение самого исполняемого файла.
- **resource_path(name)** — строит абсолютный путь к ресурсам (иконкам, текстам) как при обычном запуске скрипта, так и из собранного exe.
- **load_icon(name)** — пытается загрузить изображение значка. В случае ошибки возвращает `None`.
- **flash_tray_icon(icon, image, duration)** — временно меняет иконку в системном трее на другую, а затем возвращает исходную.
- **ensure_directories()** — создаёт папки для скачанных роликов и изображений, включая подкаталог Wildberries.
- **load_config()** — читает `config.json`, объединяя полученные данные со значениями по умолчанию. При ошибке возвращается словарь с настройками по умолчанию.
- **save_config(cfg)** — сохраняет переданный словарь в `config.json`.
- **ensure_single_instance()** — не даёт запустить второй экземпляр программы. На Windows создаётся lock‑файл.
- **download_video(url, folder)** — скачивает видео с YouTube в указанный каталог через `yt_dlp`.
- **download_playlist(url, folder)** — аналогично скачивает плейлист целиком.
- **download_pinterest_image(url, folder)** — извлекает первую картинку со страницы Pinterest и сохраняет её.
- **download_wb_images(url, folder)** — загружает все изображения товара Wildberries. Сначала по API читается `card.json`, после чего скачиваются файлы `images/big/*.webp`.
- **handle_url(url)** — определяет тип переданной ссылки и вызывает соответствующую функцию загрузки.
- **download_all(icon=None)** — читает список URL из `download-list.txt` и поочерёдно скачивает каждый. Выполняется в отдельном потоке, чтобы не блокировать интерфейс.
- **add_link_from_clipboard()** — копирует выделенный в системе текст, проверяет его и добавляет в файл со списком ссылок.
- **main()** — точка входа. Запускает проверку единственного экземпляра, готовит папки, назначает горячие клавиши и отображает значок в системном трее.

Внутри `main()` определены вспомогательные функции меню: `on_add`, `change_hotkey`, `on_download`, `on_exit`, `open_list`, `open_folder`, `show_info`. Они реагируют на действия пользователя через контекстное меню иконки.
